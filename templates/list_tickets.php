<?php/* Template Name: list_tickets.php */?><script type="text/javascript">  jQuery(document).ready(function() {  jQuery('#key4ce_ticket_list .noEdit').click(function(e){   e.stopPropagation();});});</script><style>	table { 		width: 100%; 		border-collapse: collapse; 	}	/* Zebra striping */	tr:nth-of-type(odd) { 		background: #eee; 	}	th { 		background: #333; 		color: white; 		font-weight: bold; 	}	td, th { 		padding: 6px; 		border: 1px solid #ccc; 		text-align: left; 	}	.key4ce_subject {text-align:left;}	.key4ce_priority_red,.key4ce_priority_orange,.key4ce_priority_green,.key4ce_priority_black{display:none;}	#ui-id-7{cursor:pointer;}</style><!--[if !IE]><!-->	<style>	@media 	only screen and (max-width: 760px),	(min-device-width: 768px) and (max-device-width: 1024px)  {				/* Hide table headers (but not display: none;, for accessibility) */		thead tr { 			position: absolute;			top: -9999px;			left: -9999px;		}				tr { border: 1px solid #ccc; }				td { 			/* Behave  like a "row" */			border: none;			border-bottom: 1px solid #eee; 			position: relative;		}				td:before { 			/* Now like a table header */			position: absolute;			/* Top/left values mimic padding */			top: 6px;			left: 6px;			width: 45%; 			padding-right: 10px; 			white-space: nowrap;		}		/*		Label the data		*/		/*td:nth-of-type(1):before { content: "Checkall"; }		td:nth-of-type(2):before { content: "Ticket#"; }		td:nth-of-type(3):before { content: "Subject"; }		td:nth-of-type(4):before { content: "Status"; }		td:nth-of-type(5):before { content: "Department"; }		td:nth-of-type(6):before { content: "Help Topic"; }		td:nth-of-type(7):before { content: "Date"; }*/	}		/* Smartphones (portrait and landscape) ----------- */	@media only screen	and (max-width : 760px) {		body { 			padding: 0; 			margin: 0; }		.noEdit{display:none;}		.key4ce_department , .key4ce_topic , .key4ce_datetime , .key4ce_priority{display:none;}		.key4ce_subject{width:100%;text-align:left;}		.key4ce_table {overflow: hidden;}		.key4ce_priority_red		{			display:block;			background-color:red;			float: right;			margin-right: -6px;			width: 5px;		}		.key4ce_priority_orange		{			display:block;			background-color:orange;			float: right;			margin-right: -6px;			width: 5px;		}		.key4ce_priority_green		{			display:block;			background-color:green;			float: right;			margin-right: -6px;			width: 5px;		}		.key4ce_priority_black		{			display:block;			background-color:black;			float: right;			margin-right: -6px;			width: 5px;		}		}			</style>	<!--<![endif]--><?php if($keyost_usercloseticket==0) { ?><style>#key4ce_ticket_menu1{width: 8.5% !important;}#key4ce_ticket_list1{width: 8.5% !important;}#key4ce_ticket_menu2{width: 47% !important;}#key4ce_ticket_list2{width: 47% !important;}#key4ce_ticket_menu4{width:11% !important;}#key4ce_ticket_list4{width:11% !important;}#key4ce_ticket_menu5{width:11% !important;}#key4ce_ticket_list5{width:11% !important;}#key4ce_ticket_menu6{width:250px !important;}#key4ce_ticket_list6{width:250px !important;}</style><?php }$date_formats=key4ce_getKeyValue('date_formats');$datetime_format=key4ce_getKeyValue('datetime_format');if($date_formats==24){	$datetime_format = str_replace(array('a', 'h'), array('', 'H'),$datetime_format);	$datetime_format = getStrftimeFormat($datetime_format);}else{	$datetime_format=getStrftimeFormat($datetime_format);}if(isset($_POST['close'])){	$close_ticket_list=$_POST['tickets'];	$i=0;	foreach($close_ticket_list as $close_ticket){						if($keyost_version==194 || $keyost_version==195 || $keyost_version==1951 || $keyost_version==1914)			$ost_wpdb->update($ticket_table, array('status_id'=>'3'), array('ticket_id'=>$close_ticket), array('%s'));		else			$ost_wpdb->update($ticket_table, array('status'=>'closed'), array('ticket_id'=>$close_ticket), array('%s'));		$i++;	}	echo "<div style=' color: red;font-size: 15px;font-weight: bold;margin-top: 20px;text-align: center;'>"._e( "$i record(s) has been closed successfully", 'key4ce-osticket-bridge' )."</div>";	echo "<script>window.location.href=location.href;</script>";	}if(@$list_opt) { ?><form name="osticket" id="osticket" method="post" onSubmit="if(!confirm('<?php echo __("Are you sure you want to continue?", 'key4ce-osticket-bridge'); ?>')){return false;}"><table class="key4ce_table"><thead>    <tr>        <th><?php echo __("Ticket#", 'key4ce-osticket-bridge'); ?></th>        <th class="key4ce_subject"><?php echo __("Subject", 'key4ce-osticket-bridge'); ?></th>        <th><?php echo __("Status", 'key4ce-osticket-bridge'); ?></th>        <th><?php echo __("Department", 'key4ce-osticket-bridge'); ?></th>        <th><?php echo __("Help Topic", 'key4ce-osticket-bridge'); ?></th>        <th><?php echo __("Date", 'key4ce-osticket-bridge'); ?></th>            </tr></thead><tbody><?php foreach($list_opt as $list){ @$sub_str=Format::stripslashes($list->subject); if(isset($_REQUEST['page_id'])){		$ticket_view=get_permalink()."&service=view&ticket=".$list->number;;	} else {		$ticket_view=get_permalink()."?service=view&ticket=".$list->number;	}	?>	 <tr id="key4ce_ticket_list" onclick="location.href='<?php echo $ticket_view;?>'">			 <td><?php echo $list->number; ?></td>            <td class="key4ce_subject"><?php echo key4ce_truncate($sub_str,60,'...'); ?></td>            <td class="key4ce_priority">            <?php if($list->status=='closed') { 				echo '<font color=red>'.__("Closed", 'key4ce-osticket-bridge').'</font>'; 				}				elseif ($list->status=='open' && $list->isanswered=='0') {				echo '<font color=green>'.__('Open', 'key4ce-osticket-bridge').'</font>'; 					}				elseif ($list->status=='open' && $list->isanswered=='1') { 				echo '<font color=orange>'.__("Answered", 'key4ce-osticket-bridge').'</font>'; 				} 				?>            </td>            <td class="key4ce_department"><?php echo $list->dept_name; ?></td>            <td class="key4ce_topic"><?php echo $list->topic; ?></td>            <td class="key4ce_datetime">            <?php             if ($list->updated=='0000-00-00 00:00:00'){            $date_str  = "".$list->created."";            }else{            $date_str  = "".$list->updated."";             }            echo __formatDate($datetime_format,$date_str);            ?>            </td>                   </tr><?php } ?></tbody></table></form><?php } ?>